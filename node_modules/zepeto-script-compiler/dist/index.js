(()=>{"use strict";var __webpack_modules__={919:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.walkSync=t.hasMember=t.hasStaticMember=t.findNode=t.patch=void 0;const i=r(147);const s=r(17);function patch(e,t,r){let i=e[t];e[t]=function(...e){return r.call(this,i.bind(this),...e)};return e}t.patch=patch;function findNode(e,t){const r=[e];while(r.length){const s=r.pop();if(!s)break;let n=s.getStart(e,true);let a=s.getEnd();if(t>=n&&t<=a){var i=s.getChildren(e);if(i.length==0)return s;r.push(...i)}}return null}t.findNode=findNode;function hasMemberWithBaseTypes(e,t,r){var i=r(e,t);if(i)return i;var s=e;if(s.checker&&e.symbol){e=s.checker.getDeclaredTypeOfSymbol(e.symbol);if(e&&e.isClassOrInterface()){var n=s.checker.getBaseTypes(e);if(n){for(const e of n){if(hasMemberWithBaseTypes(e,t,r))return e}}}}}function hasStaticMember(e,t){return hasMemberWithBaseTypes(e,t,((e,t)=>{if(e.symbol&&e.symbol.exports&&e.symbol.exports.has(t)){return e}}))}t.hasStaticMember=hasStaticMember;function hasMember(e,t){return hasMemberWithBaseTypes(e,t,((e,t)=>{if(e.symbol&&e.symbol.members&&e.symbol.members.has(t)){return e}}))}t.hasMember=hasMember;function*walkSync(e){const t=i.readdirSync(e,{withFileTypes:true});for(const r of t){if(r.isDirectory()){yield*walkSync(s.join(e,r.name))}else{yield s.join(e,r.name)}}}t.walkSync=walkSync},993:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.OperatorNames=void 0;const i=r(440);const s=r(919);const n=r(375);t.OperatorNames={[i.SyntaxKind.PlusToken]:"op_Addition",[i.SyntaxKind.MinusToken]:"op_Subtraction",[i.SyntaxKind.AsteriskToken]:"op_Multiply",[i.SyntaxKind.SlashToken]:"op_Division",[i.SyntaxKind.PlusEqualsToken]:"op_Addition",[i.SyntaxKind.MinusEqualsToken]:"op_Subtraction",[i.SyntaxKind.AsteriskEqualsToken]:"op_Multiply",[i.SyntaxKind.SlashEqualsToken]:"op_Division",[i.SyntaxKind.EqualsEqualsToken]:"op_Equality",[i.SyntaxKind.ExclamationEqualsToken]:"op_Inequality"};class BinaryExpressionExtension extends n.ExtensionBase{static patch(e,r){let n=e.getTypeChecker();var a=r;var o=a.createBinaryExpressionTrampoline;if(o){try{(0,s.patch)(a,"createBinaryExpressionTrampoline",((e,r,s,a,o,l,c)=>e(r,s,a,o,((e,r)=>{var s=t.OperatorNames[e.operatorToken.kind];if(s){if(r.skip==false){var a=r.typeStack[r.stackIndex];var o=r.typeStack[r.stackIndex+1];var c=BinaryExpressionExtension.getExtendedBinaryOperator(n,s,a,o);e.__ExtendedBinaryOperator=c;if(c){return c.returnType}}}else if(e.operatorToken.kind==i.SyntaxKind.EqualsToken&&i.isBinaryExpression(e.right)){var p=e.right;if(p.__ExtendedBinaryOperator){return p.__ExtendedBinaryOperator.returnType}}return l(e,r)}),c)))}catch(e){console.log(e)}}}static execute(e,r){if(i.isBinaryExpression(e)==false)return null;let s=e;let n=s.operatorToken.kind;var a=t.OperatorNames[n];if(!a)return null;let o=e.__ExtendedBinaryOperator;if(!e.__ExtendedBinaryOperator){return null}let l=o.returnType;if(!l||!o||!o.operator||!o.operator.valueDeclaration)return null;r.referencedAliasDeclarations.add(o.ownerType.symbol.name);var c=i.factory.createIdentifier(a);if(i.isMethodDeclaration(o.operator.valueDeclaration)||i.isMethodSignature(o.operator.valueDeclaration)){if(i.isIdentifier(o.operator.valueDeclaration.name)){c=o.operator.valueDeclaration.name}}if(o.memberOperator){var p=i.visitEachChild(s,r.visitor,r.transformationContext);var f=r.transformationContext.factory;return f.createCallExpression(f.createPropertyAccessExpression(p.left,c),undefined,[p.right])}var u=e.getSourceFile();var y;if(u.locals){var d=u.locals.get(o.ownerType.symbol.escapedName);if(d&&d.declarations&&d.declarations.length){y=d.declarations[0].name}}if(!y){var m=e.getSourceFile();var h=m.imports;let t=o.ownerType.symbol;let s=undefined;let n;let a=[];while(t){a.unshift(t.name.replace(/['|"]/g,""));t=t.parent}n=a.shift();if(a.length>0){n=r.InsertImportDeclarations(n);y=i.factory.createPropertyAccessExpression(i.factory.createIdentifier(n),i.factory.createIdentifier(a.join(".")))}else{return null}}var p=i.visitEachChild(s,r.visitor,r.transformationContext);var f=r.transformationContext.factory;var x=f.createCallExpression(f.createPropertyAccessExpression(y,c),undefined,[p.left,p.right]);if(n==i.SyntaxKind.PlusEqualsToken||n==i.SyntaxKind.MinusEqualsToken||n==i.SyntaxKind.AsteriskEqualsToken||n==i.SyntaxKind.SlashEqualsToken){return f.createBinaryExpression(p.left,f.createToken(i.SyntaxKind.EqualsToken),x)}return x}static isTypeEqual(e,t){if(e==t)return true;if(e.symbol&&t.symbol){if(e.symbol==t.symbol)return true;if(e.symbol.valueDeclaration==t.symbol.valueDeclaration)return true}else if(e.flags==t.flags){if(e.id&&e.id==t.id)return true;if(e.intrinsicName&&e.intrinsicName==t.intrinsicName)return true}return false}static CompareTypes(e,t){var r;if(t.intrinsicName=="error"){return true}if(t.intrinsicName=="null")return true;if(this.isTypeEqual(e,t))return true;if((r=t.getBaseTypes())===null||r===void 0?void 0:r.some((t=>this.isTypeEqual(e,t)))){return true}}static findMatchedBinaryOperator(e,t,r,n,a){t=(0,s.hasStaticMember)(t,r);if(t){var o=t.symbol.exports.get(r);if(o==null)return null;var l=o.getDeclarations();if(l){for(const r of l){if(i.isMethodDeclaration(r)){var c=r.parameters;if(c&&c.length==2){var p=c.map((t=>{var r=e.getTypeAtLocation(t.type);return r}));if(BinaryExpressionExtension.CompareTypes(p[0],n)&&BinaryExpressionExtension.CompareTypes(p[1],a)){return{ownerType:t,returnType:e.getTypeAtLocation(r.type)}}}}}}}return null}static getExtendedBinaryOperator(e,t,r,i){r=e.getBaseTypeOfLiteralType(r);i=e.getBaseTypeOfLiteralType(i);let s=BinaryExpressionExtension.findMatchedBinaryOperator(e,r,t,r,i);if(s){const e=this.getStaticMember(r,t);return{ownerType:s.ownerType,returnType:s.returnType,operator:e}}s=BinaryExpressionExtension.findMatchedBinaryOperator(e,i,t,r,i);if(s){const e=this.getStaticMember(i,t);return{ownerType:s.ownerType,returnType:s.returnType,operator:e}}}static getStaticMember(e,t){let r=e.symbol.exports.get(t);if(!r)r=e.getBaseTypes().map((e=>e.symbol.exports)).find((e=>e.has(t))).get(t);return r}}t["default"]=BinaryExpressionExtension},591:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.BuiltInDecorators=void 0;const i=r(440);const s=r(375);t.BuiltInDecorators=new Set(["NonSerialized","HideInInspector","SerializeField","Header","Space","Tooltip"]);class DecoratorExtension extends s.ExtensionBase{static execute(e,r){if(i.isDecorator(e)&&i.isPropertyDeclaration(e.parent)&&i.isCallExpression(e.expression)){var s=e.expression;if(i.isIdentifier(s.expression)&&t.BuiltInDecorators.has(s.expression.escapedText.toString())){return i.factory.createEmptyStatement()}}return null}}t["default"]=DecoratorExtension},652:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});const i=r(440);const s=r(919);const n=r(375);class ElementAccessExpressionExtension extends n.ExtensionBase{static execute(e,t){if(i.isBinaryExpression(e)){if(e.operatorToken.kind==i.SyntaxKind.EqualsToken&&i.isElementAccessExpression(e.left)){let r=e.left;let n=t.typeChecker.getTypeAtLocation(r.expression);if(t.typeChecker.isArrayType(n))return;let a="set_Item";if((0,s.hasMember)(n,a)){let t=i.factory;return t.createCallExpression(t.createPropertyAccessExpression(r.expression,t.createIdentifier(a)),undefined,[r.argumentExpression,e.right])}}return}if(i.isElementAccessExpression(e)==false)return;let r=e;let n=t.typeChecker.getTypeAtLocation(r.expression);if(t.typeChecker.isArrayType(n))return;let a="get_Item";if((0,s.hasMember)(n,a)){let e=i.factory;return e.createCallExpression(e.createPropertyAccessExpression(r.expression,e.createIdentifier(a)),undefined,[r.argumentExpression])}}}t["default"]=ElementAccessExpressionExtension},678:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});const i=r(440);const s=r(440);const n=r(919);const a=r(375);class EventHandlerExtension extends a.ExtensionBase{static patch(e,t){let r=e.getTypeChecker();(0,n.patch)(e,"getSemanticDiagnostics",((e,t,a)=>{var o=e(t,a);o=o.filter((e=>{if(e.code==2363){var t=(0,n.findNode)(e.file,e.start);while(t){if((0,i.isBinaryExpression)(t)){if(t.operatorToken.kind==s.SyntaxKind.MinusEqualsToken&&s.isPropertyAccessExpression(t.left)){let e=r.getTypeAtLocation(t.left.expression);let i=`remove_${t.left.name.escapedText}`;if((0,n.hasStaticMember)(e,i)||(0,n.hasMember)(e,i)){return false}}break}t=t.parent}}return true}));return o}))}static execute(e,t){if(s.isBinaryExpression(e)&&(e.operatorToken.kind==s.SyntaxKind.PlusEqualsToken||e.operatorToken.kind==s.SyntaxKind.MinusEqualsToken)&&s.isPropertyAccessExpression(e.left)){let a=t.typeChecker.getTypeAtLocation(e.left.expression);let o=(e.operatorToken.kind==s.SyntaxKind.PlusEqualsToken?"add_":"remove_")+e.left.name.escapedText;if((0,n.hasStaticMember)(a,o)||(0,n.hasMember)(a,o)){let n=s.factory;let a=e;var r=s.visitEachChild(a,t.visitor,t.transformationContext);if(s.isPropertyAccessExpression(r.left)){var i=r.right;if(s.isArrowFunction(r.right)==false){i=n.createCallExpression(n.createPropertyAccessExpression(r.right,n.createIdentifier("bind")),undefined,[n.createThis()])}return n.createCallExpression(n.createPropertyAccessExpression(r.left.expression,n.createIdentifier(o)),undefined,[i])}}}}}t["default"]=EventHandlerExtension},375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.ExtensionBase=t.ExtensionContext=void 0;const i=r(440);const s=r(919);class ExtensionContext{constructor(e){this.symboleIdentifiers=new WeakMap;this.program=e;this.typeChecker=e.getTypeChecker();this.referencedAliasDeclarations=new Set;this.importDeclarations=new Map}InsertImportDeclarations(e){var t=`__${e}__`;if(this.importDeclarations.has(e)==false){var r=i.factory;var s=r.createImportDeclaration(undefined,undefined,r.createImportClause(false,undefined,r.createNamespaceImport(r.createIdentifier(t))),r.createStringLiteral(e));this.importDeclarations.set(e,s)}return t}updateImportDeclarations(e){if(this.importDeclarations&&this.importDeclarations.size>0){e=i.factory.updateSourceFile(e,[...this.importDeclarations.values(),...e.statements])}return e}visit(e){if(i.isImportSpecifier(e)||i.isNamespaceImport(e)){let t=this.typeChecker.getTypeAtLocation(e.name);if(t.symbol){this.symboleIdentifiers.set(t.symbol,e.name)}}}setTransformationContext(e){this.transformationContext=e;this.resolver=e.getEmitResolver();(0,s.patch)(this.resolver,"isReferencedAliasDeclaration",((e,t,r)=>{const s=e(t,r);if(s==false){let e;if(i.isImportClause(t)){try{e=this.typeChecker.getTypeAtLocation(t)}catch(e){}}else if(i.isNamedImports(t.parent)){e=this.typeChecker.getTypeAtLocation(t)}else if(i.isNamespaceImport(t)){return true}if(e&&e.symbol&&this.referencedAliasDeclarations.has(e.symbol.name)){return true}}return s}))}isReferencedAliasDeclaration(e,t,r){var i=e(t,r);return i}}t.ExtensionContext=ExtensionContext;class ExtensionBase{static patch(e,t){}static execute(e,t){return null}}t.ExtensionBase=ExtensionBase;ExtensionBase.isPatched=false},544:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});const i=r(440);const s=r(375);class ExtensionMethodExtension extends s.ExtensionBase{static execute(e,t){if(i.isCallExpression(e)&&i.isPropertyAccessExpression(e.expression)){var r=t.typeChecker.getSymbolAtLocation(e.expression);if(!r||!r.valueDeclaration)return;var s;var n=i.getJSDocTags(r.valueDeclaration);if(n&&n.length>0){for(let e=0;e<n.length;e++){const t=n[e];if(t.tagName.escapedText=="extension"){s=t.comment;break}}}if(!s)return;var a=i.factory;var o=[e.expression.expression];o=o.concat(e.arguments);return a.createCallExpression(a.createPropertyAccessExpression(a.createCallExpression(a.createIdentifier("$extension"),undefined,[a.createStringLiteral(s)]),e.expression.name),undefined,o)}}}t["default"]=ExtensionMethodExtension},937:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});const i=r(440);const s=r(375);const n=r(919);class FroLoopExtension extends s.ExtensionBase{static patch(e,t){(0,n.patch)(e,"getSemanticDiagnostics",((t,r,i)=>{let s=t(r,i);s=s.filter((t=>{if(t.code==2488){const r=(0,n.findNode)(t.file,t.start);if(this.IsIEnumerable(r,e.getTypeChecker())){return false}}return true}));return s}))}static execute(e,t){if(e.parent&&(i.isForOfStatement(e.parent)||i.isForInStatement(e.parent))){if(i.isIdentifier(e)||i.isPropertyAccessExpression(e)||i.isCallExpression(e)){if(this.IsIEnumerable(e,t.typeChecker)){return i.factory.createCallExpression(i.factory.createIdentifier("$IEnumerableToArray"),undefined,[i.factory.createIdentifier(e.getFullText())])}}}return null}static IsIEnumerable(e,t){const r=t.getTypeAtLocation(e);if(r){const e=r.symbol.escapedName.toString().split("$")[0];if(e=="IEnumerable"){return true}}return false}}t["default"]=FroLoopExtension},953:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});const i=r(440);const s=r(375);function IsMethodSignatureOrDeclaration(e){return i.isMethodDeclaration(e)||i.isMethodSignature(e)}class ElementAccessExpressionExtension extends s.ExtensionBase{static execute(e,t){if(i.isNewExpression(e)&&i.isIdentifier(e.expression)&&e.typeArguments&&e.typeArguments.length>0){var r=e.expression.escapedText.toString().split("$");if(r.length!=2)return;var s=parseInt(r[1]);if(e.typeArguments.length!=s)return;var n=i.factory;var a=[e.expression];for(let r=0;r<e.typeArguments.length;r++){const s=e.typeArguments[r];if(i.isTypeReferenceNode(s)&&i.isIdentifier(s.typeName)){var o=t.typeChecker.getTypeAtLocation(s.typeName);if(o.flags==i.TypeFlags.Object){t.referencedAliasDeclarations.add(o.symbol.name);a.push(s.typeName)}else{a.push(n.createCallExpression(n.createIdentifier("$typeof"),undefined,[n.createStringLiteral(s.typeName.escapedText.toString())]))}}else{let e;if(s.kind==i.SyntaxKind.NumberKeyword){e=i.factory.createStringLiteral("System.Double")}else if(s.kind==i.SyntaxKind.StringKeyword){e=i.factory.createStringLiteral("System.String")}else if(s.kind==i.SyntaxKind.BooleanKeyword){e=i.factory.createStringLiteral("System.Boolean")}if(e){const t=i.factory.createCallExpression(i.factory.createIdentifier("$typeof"),undefined,[e]);a.push(t)}}}return n.createNewExpression(n.createParenthesizedExpression(n.createCallExpression(n.createIdentifier("$generic"),undefined,a)),undefined,e.arguments)}else if(i.isCallExpression(e)&&i.isPropertyAccessExpression(e.expression)&&e.typeArguments&&e.typeArguments.length>0){var l=t.typeChecker;var c=l.getSymbolAtLocation(e.expression);if(!c)return;var p=l.getResolvedSignature(e);if(!p||IsMethodSignatureOrDeclaration(p.declaration)==false)return;var f=p.declaration;if(IsMethodSignatureOrDeclaration(f)&&f.typeParameters){var u=f.typeParameters;var y=f.parameters||[];for(let r=0;r<c.declarations.length;r++){const s=c.declarations[r];if(s!=f&&IsMethodSignatureOrDeclaration(s)&&!s.typeParameters){if(s&&s.parameters&&s.parameters.length==y.length+1){var d=l.getTypeAtLocation(s.parameters[0].name);var m=d.symbol;if(!m)continue;var h=m.parent;if(d.symbol.name=="Type"&&h&&(h.name=="System"||h.name=='"System"')){var x=true;for(let e=0;e<y.length;e++){var g=l.getTypeAtLocation(y[e]);var v=l.getTypeAtLocation(s.parameters[e+1]);if(g!=v&&g.symbol!=v.symbol){if(g.aliasSymbol==v.aliasSymbol){if(v.aliasTypeArguments){var E=v.aliasTypeArguments;if(!E.find((e=>!e||e.intrinsicName!=="any")))continue}}x=false;break}}if(x){var T=e.arguments.slice(0);var _=e.typeArguments[0];var S;var b;if(i.isTypeQueryNode(_)){S=_.exprName}if(i.isTypeReferenceNode(_)){if(i.isIdentifier(_.typeName)){S=_.typeName}else if(i.isQualifiedName(_.typeName)){S=_.typeName.right;let e=t.InsertImportDeclarations(_.typeName.left.getFullText());b=i.factory.createIdentifier(e)}}if(S&&i.isIdentifier(S)){let r=l.getTypeAtLocation(S);let s=l.getTypeAtLocation(e.expression.expression);if(r.symbol)t.referencedAliasDeclarations.add(r.symbol.name);if(s.symbol)t.referencedAliasDeclarations.add(s.symbol.name);if(r.symbol&&r.symbol.flags==i.SymbolFlags.Interface)return;let n;if(b){n=i.factory.createCallExpression(i.factory.createIdentifier("$typeof"),undefined,[i.factory.createPropertyAccessExpression(b,S)])}else{n=i.factory.createCallExpression(i.factory.createIdentifier("$typeof"),undefined,[S])}T.unshift(n)}else if(!S){var k;if(_.kind==i.SyntaxKind.NumberKeyword){k=i.factory.createStringLiteral("System.Double")}else if(_.kind==i.SyntaxKind.StringKeyword){k=i.factory.createStringLiteral("System.String")}else if(_.kind==i.SyntaxKind.BooleanKeyword){k=i.factory.createStringLiteral("System.Boolean")}if(k){var D=i.factory.createCallExpression(i.factory.createIdentifier("$typeof"),undefined,[i.factory.createCallExpression(i.factory.createIdentifier("$typeof"),undefined,[k])]);T.unshift(D)}}return i.factory.createCallExpression(e.expression,undefined,T)}}}}}}return}}}t["default"]=ElementAccessExpressionExtension},555:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.extensions=void 0;const i=r(953);const s=r(993);const n=r(652);const a=r(678);const o=r(591);const l=r(544);const c=r(937);const p=[s.default,n.default,a.default,i.default,o.default,l.default,c.default];t.extensions=p},822:(e,t,r)=>{const i=r(555);const s=r(921);(0,s.startServer)();function init(e){console.log("init");function create(e){const t=Object.create(null);for(let r of Object.keys(e.languageService)){t[r]=(...t)=>{var i=e.languageService[r].apply(e.languageService,t);return i}}return t}var t=e.typescript.createProgram;e.typescript.createProgram=(...r)=>{var s=t.apply(e.typescript,r);for(const t of i.extensions){t.patch(s,e.typescript)}return s};return{create:create}}e.exports=init},289:(__unused_webpack_module,exports,__nccwpck_require__)=>{Object.defineProperty(exports,"__esModule",{value:true});exports.parseManifest=exports.Manifest=void 0;const module_1=__nccwpck_require__(188);const path=__nccwpck_require__(17);const ts=__nccwpck_require__(440);const DecoratorExtension_1=__nccwpck_require__(591);class Manifest{constructor(){this.properties=[]}}exports.Manifest=Manifest;function parseManifest(sourceFile,typeChecker){var manifest=new Manifest;for(let e=0;e<sourceFile.statements.length;e++){const t=sourceFile.statements[e];if(ts.isClassDeclaration(t)&&t.name){manifest.name=t.name.escapedText.toString();break}}if(!manifest.name){manifest.name=path.basename(sourceFile.fileName,".ts")}function getPropertyTypeName(type,propertyDeclarationType){if(type.intrinsicName){if(propertyDeclarationType&&ts.isTypeReferenceNode(propertyDeclarationType)&&ts.isIdentifier(propertyDeclarationType.typeName)){if(type.intrinsicName!=propertyDeclarationType.typeName.escapedText){return{type:propertyDeclarationType.typeName.escapedText.toString()}}}return{type:type.intrinsicName}}else{if(propertyDeclarationType&&ts.isArrayTypeNode(propertyDeclarationType)){let e=typeChecker.getTypeAtLocation(propertyDeclarationType.elementType);let t=getPropertyTypeName(e,propertyDeclarationType.elementType);if(t)t.isArray=true;return t}else if(type.symbol){var fullTypeName=[];var result={};var currentType=type.symbol;var isEnumModule=false;while(currentType){if(currentType.valueDeclaration){if(ts.isEnumDeclaration(currentType.valueDeclaration)&&currentType.parent&&currentType.parent.valueDeclaration&&ts.isSourceFile(currentType.parent.valueDeclaration)){try{var sourceCode=currentType.valueDeclaration.getFullText();var transpiled=module_1.Module.wrap(ts.transpile(sourceCode,{noEmitOnError:false}));let exports={};eval(transpiled)(exports);var allEnumValues=exports[currentType.escapedName];if(allEnumValues){var enumKeys=[];var enumValues=[];if(currentType.exports){currentType.exports.forEach(((e,t)=>{var r=t.toString();if(allEnumValues[r]!==undefined){enumKeys.push(t.toString());enumValues.push(allEnumValues[r])}}));result.enumKeys=enumKeys;result.enumValues=enumValues}}result.type=currentType.escapedName.toString();return result}catch(e){throw new Error("Enum Property Parse Error")}}}var name=currentType.escapedName.toString();if(currentType.flags==ts.SymbolFlags.ValueModule){fullTypeName.unshift(name.substring(1,name.length-1))}else{fullTypeName.unshift(name)}currentType=currentType.parent}result.type=fullTypeName.join(".");return result}}}function getProperties(e){const t=["Map"];var r=[];if(e.symbol&&e.symbol.escapedName!="ZepetoScriptBehaviour"&&e.symbol.members){e.symbol.members.forEach((e=>{if(e.valueDeclaration&&ts.isPropertyDeclaration(e.valueDeclaration)){var i=false;if(e.valueDeclaration.modifiers){for(let t=0;t<e.valueDeclaration.modifiers.length;t++){const r=e.valueDeclaration.modifiers[t];if(r.kind==ts.SyntaxKind.PrivateKeyword||r.kind==ts.SyntaxKind.ProtectedKeyword){i=true;break}}}var s=typeChecker.getTypeAtLocation(e.valueDeclaration);var n=getPropertyTypeName(s,e.valueDeclaration.type);if(n){const s=t.includes(n.type);n.name=e.escapedName.toString();n.initValue=getInitValue(e.valueDeclaration);var a=getAttributes(e.valueDeclaration);if(a&&a.length){n.attributes=a}if(s==false&&(i==false||n.attributes&&n.attributes.find((e=>e.name=="SerializeField")))){r.push(n)}}}}))}var i=typeChecker.getBaseTypes(e);if(i){for(const e of i){var s=getProperties(e);r=r.concat(s)}}return r}function getAttributes(e){let t=[];let r=ts.getDecorators(e);if(r){for(let e=0;e<r.length;e++){const s=r[e];if(ts.isCallExpression(s.expression)&&ts.isIdentifier(s.expression.expression)){var i=s.expression.expression;if(DecoratorExtension_1.BuiltInDecorators.has(i.escapedText.toString())){let e=s.expression.arguments;let r=e.map((e=>e.getText()));t.push({name:i.escapedText,args:r})}}}}return t}function getInitValue(e){const t=e.initializer;if(t){if(t.text){return[t.text]}if(t.name){return[t.name.escapedText]}if(t.elements){return t.elements.map((e=>e.text))}}}function hasMethod(e,t){let r=false;if(e.symbol&&e.symbol.escapedName!="ZepetoScriptBehaviour"&&e.symbol.members){e.symbol.members.forEach((e=>{if(e.valueDeclaration&&ts.isMethodDeclaration(e.valueDeclaration)&&e.name==t){r=true}}))}return r}sourceFile.forEachChild((e=>{if(ts.isClassDeclaration(e)){const t=typeChecker.getTypeAtLocation(e);if(t.symbol&&t.symbol.escapedName==="default"){const e=getProperties(t);manifest.hasAnimatorMove=hasMethod(t,"OnAnimatorMove");for(const t of e){manifest.properties.push(t)}}}}));return manifest}exports.parseManifest=parseManifest},921:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.startServer=void 0;const i=r(147);const s=r(17);const n=r(440);const a=r(555);const o=r(788);const l=r(289);const c=r(685);const p=r(919);const f=r(113);class FileVersion{constructor(){this.version=0}}class CompileResultFile{static from(e,t){var r=new CompileResultFile;r.fileName=e.name;r.source=e.text;r.errors=t||[];return r}}class CompilerServer{constructor(e){this._projectFile=e;n.getFileEmitOutput=this.getFileEmitOutput;this.files=new Map;this.servicesHost={getScriptFileNames:()=>this.ensureScriptFileNames(),getScriptVersion:e=>this.getFile((0,s.join)(e)).version.toString(),getScriptSnapshot:e=>i.existsSync(e)?n.ScriptSnapshot.fromString(i.readFileSync(e).toString()):undefined,getCurrentDirectory:()=>process.cwd(),getCompilationSettings:()=>this._compilerOptions,getDefaultLibFileName:e=>n.getDefaultLibFilePath(e),fileExists:n.sys.fileExists,readFile:n.sys.readFile,readDirectory:n.sys.readDirectory,directoryExists:n.sys.directoryExists,getDirectories:n.sys.getDirectories};this.services=n.createLanguageService(this.servicesHost,n.createDocumentRegistry());this.server=(0,c.createServer)(this.onRequest.bind(this))}ensureScriptFileNames(){return Array.from(this.files.keys()).filter((e=>{if(i.existsSync(e)==false){this.files.delete(e);return false}return true}))}ensureCompilationSettings(){if(this.servicesHost.fileExists(this._projectFile)==false){return{}}else{var e=+i.statSync(this._projectFile).mtime;if(!this._compilerOptions||this._compilerOptionsVersion!=e){this._compilerOptionsVersion=e;var t=readConfig(n,this._projectFile,(0,s.dirname)(this._projectFile));this._compilerOptions=t.options;this._compilerOptions.noEmitOnError=true;this.files.clear()}}return this._compilerOptions}getFileEmitOutput(e,t,r,i,s,c){s={before:[(0,o.createTransformer)(e)]};for(const t of a.extensions){if(!t.isPatched){t.patch(e,n);t.isPatched=true}}var p=new CompileResultFile;p.fileName=t.fileName;p.manifest=(0,l.parseManifest)(t,e.getTypeChecker());var f=e.emit(t,writeFile,i,r,s,c);p.errors=f.diagnostics.map((e=>{let t=n.flattenDiagnosticMessageText(e.messageText,"\n");if(e.file){let{line:r,character:i}=e.file.getLineAndCharacterOfPosition(e.start);return`${e.file.fileName} (${r+1},${i+1}): ${t}`}else{return t}}));var u=n;var y=u.FindAllReferences.Core.getReferencesForFileName(p.fileName,e,e.getSourceFiles());y=y.map((e=>{if(e.fileName)return e.fileName;var t=e.node.getSourceFile();return t.fileName}));return{result:p,references:y};function writeFile(e,t,r){p.source=t}}initialize(e){this.files.clear();if(e)e.forEach((e=>this.getFile(e)))}getFile(e){var t=this.files.get(e);if(!t){t=new FileVersion;this.files.set(e,t)}return t}checksumFile(e,t){return(0,f.createHash)(e).update(`${i.readFileSync(t,"utf-8")}#${t}`).digest("hex")}buildFiles(e){e=e.filter(this.servicesHost.fileExists);var t=new Map;for(const s of e){var r=i.statSync(s).mtime;t.set(s,r)}e=e.sort(((e,r)=>t.get(r)-t.get(e)));this.ensureCompilationSettings();for(const r of e){this.getFile(r).version=+t.get(r)||0}let s=new Set;return[].concat(...e.map((e=>this.emitFile(e,s))))}emitFile(e,t){if(!t)t=new Set;else if(t.has(e))return[];var r=Date.now();let i;try{i=this.services.getEmitOutput(e)}catch(t){i={result:{fileName:e,source:null,manifest:null,errors:[t.toString()]},references:[]}}console.log("emit ",Date.now()-r,"ms - ",e);r=Date.now();t.add(e);var s=[i.result];if(i.references){i.references.forEach((e=>{s=s.concat(this.emitFile(e,t))}))}return s}getErrors(e){let t=this.services.getSyntacticDiagnostics(e).concat(this.services.getSemanticDiagnostics(e));return t.map((e=>{let t=n.flattenDiagnosticMessageText(e.messageText,"\n");if(e.file){let{line:r,character:i}=e.file.getLineAndCharacterOfPosition(e.start);return`${e.file.fileName} (${r+1},${i+1}): ${t}`}else{return t}}))}listen(e,t){this.server.requestTimeout=1e3*60*15;this.server.listen(e,t)}onRequest(e,t){var r=new URL(e.url,"http://localhost");if(r.pathname=="/health"){t.writeHead(200,{"Content-Type":"application/json"});t.write("OK");t.end()}else if(r.pathname=="/files"){t.writeHead(200,{"Content-Type":"application/json"});t.write(JSON.stringify({files:this.ensureScriptFileNames()}));t.end()}else if(e.method=="POST"){var i="";e.on("data",(e=>i+=e));e.on("end",(()=>{try{t.writeHead(200,{"Content-Type":"application/json"});var e=JSON.parse(i);if(e.files){if(r.pathname=="/init"){if(e.projectFile)this._projectFile=e.projectFile;this.initialize(e.files)}else if(r.pathname=="/build"){var s=this.buildFiles(e.files);if(r.searchParams.get("debug")){t.write(s[0].source)}else{t.write(JSON.stringify({files:s}))}}}t.end()}catch(e){t.writeHead(400);t.write(e.stack?e.stack:e.toString());t.end()}}))}else{t.writeHead(400);t.end()}}}function readConfig(e,t,r){const i=e.readConfigFile(t,e.sys.readFile);if(i.error){throw new Error("tsconfig.json error: "+i.error.messageText)}return e.parseJsonConfigFileContent(i.config,e.sys,r,undefined,t)}function startServer(){let e=undefined;let t=18082;let i;var n=process.argv.slice(2);let a;let o;for(let i=0;i<n.length;i++){if(n[i]=="-v"||n[i]=="--version"){var l=r(598).i8;console.log(l);return}else if(n[i]=="--project"){e=n[++i]}else if(n[i]=="--port"){t=parseInt(n[++i])||t}else if(n[i]=="-f"||n[i]=="--file"){a=n[++i]}else if(n[i]=="-d"||n[i]=="--dir"){o=n[++i]}}{let r=parseInt(process.env["UNITY_PROCESS_ID"]||"0");if(r){var c=setInterval((()=>{let e=false;try{e=process.kill(r,0)}catch(t){e=t.code==="EPERM"}if(!e){console.log("no activity in the process and it terminate");process.exit(0)}}),2e3)}var f=new CompilerServer(e);f.listen(t,(e=>{if(e){console.error(e)}if(a){var t=f.buildFiles([a]);console.log(t[0].manifest);console.log(t[0].source)}else if(o){let e=[];for(const t of(0,p.walkSync)(o)){if((0,s.extname)(t)!==".ts"){continue}e.push(t)}var t=f.buildFiles(e);console.log(t[0].manifest);console.log(t[0].source)}else{console.log("not exist initFile")}}))}}t.startServer=startServer},788:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});t.createTransformer=t.TransformerRemoveNode=void 0;const i=r(440);const s=r(555);const n=r(375);t.TransformerRemoveNode=Symbol("__REMOVE__");function createTransformer(e){return function(r){let a=new n.ExtensionContext(e);a.setTransformationContext(r);const visitor=e=>{a.visit(e);for(let r=0;r<s.extensions.length;r++){const i=s.extensions[r];let n=i.execute(e,a);if(n){if(n===t.TransformerRemoveNode)return null;return n}}return(0,i.visitEachChild)(e,visitor,r)};a.visitor=visitor;return e=>{e=(0,i.visitNode)(e,visitor);e=a.updateImportDeclarations(e);return e}}}t.createTransformer=createTransformer},113:e=>{e.exports=require("crypto")},147:e=>{e.exports=require("fs")},685:e=>{e.exports=require("http")},188:e=>{e.exports=require("module")},17:e=>{e.exports=require("path")},440:e=>{e.exports=require("typescript")},598:e=>{e.exports={i8:"0.1.89"}}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var r=__webpack_module_cache__[e]={exports:{}};var i=true;try{__webpack_modules__[e](r,r.exports,__nccwpck_require__);i=false}finally{if(i)delete __webpack_module_cache__[e]}return r.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(822);module.exports=__webpack_exports__})();